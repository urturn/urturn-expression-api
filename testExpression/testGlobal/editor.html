<h1>TEST ALL Functions</h1>

<script type="text/javascript">
  // A GLOBAL
  var post = null;
  // Bootstrap you expression editor
  UT.Expression.ready(function(exp){
    // Read more in test.js
    post = exp;

    var test = new Test(post);
    test.bindEvents();

    post.on('publish', function(){
      console.log('set the final size');
      post.storage.height = post.node.offsetHeight;
      post.save();
    })
  });
</script>

<input type='button' value='setPublishFunction'
    onclick='post.on("publish", function(){alert("User Will Publish");})'/> <br/>

<input type='button' value='valid' onclick='post.valid(true)'/>
<input type='button' value='invalid' onclick='post.valid(false)'/><br/>

<input type='button' value='create Image' onclick='createImage()'/>
<input type='button' value='crop Image' onclick='cropImage()'/>
<input type='button' value='Filter Image' onclick='filterImage()'/>
<input type='button' value='toJSON' onclick='jsonImage()'/>
<br/>
<img id='testImage1' />
<br/>
<input type='button' value='QueueUp' onclick='queueUp()'/>
<br/>
<input type="text" value="200" id="height"/><input type='button' value='Resize' onclick='doResize()'/>
<br/>

<script>
	var image = null;

	function newImage(data){
		image = data;
		document.getElementById("testImage1").src = data.url;
	}

	function createImage() {
		post.dialog("image", newImage);
	}

	function cropImage() {
		post.dialog(
			'crop',
			{
				image : image,
				size : {width : 100, height : 100, felxRatio : true}
			},
			newImage);
	}

  function doResize() {
    post.resize({height: post.node.querySelector('#height').value});
  }

	function jsonImage() {
		console.log(image.toJSON());
	}

	function filterImage() {
		image.filter([{"filter":"threshold","parameters":{"strength":"0.41","alpha":"0.9","primaryColor":[0,0,0],"secondaryColor":[255,255,255]}}], newImage);
	}

  function queueUp() {
    post.queueUp('test', function(number){
      var p = document.createElement('p');
      p.innerHTML = 'Get #' + number;
      post.node.appendChild(p);
    });
  }
</script>